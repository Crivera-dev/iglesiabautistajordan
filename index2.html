<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Galer√≠a tipo collage</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- PhotoSwipe -->
    <link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">
    <style>
    .caption {
           background: rgba(0, 0, 0, 0.7);
    }
</style>
</head>

<body class="container-fluid py-4">

<section class="text-center mb-4">
    <h1 class="text-center mb-5">Mi Galeria de Vidos</h1>
    <div class="container-fluid">
      <div id="carouselExampleCaptions" class="carousel slide">
        <div class="carousel-indicators" id="indicators"></div>
        <div class="carousel-inner" id="galleryWrapper"></div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
  </section>
   <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
   <script>
        
            const apiKeys = "AIzaSyAVZLFo5wJv_LokSiyVDMIi96yT_queamc";
            const channelId = "UC-8S74z-luj-bFuEwlGOQLw"; //UCkccyEbqhhM3uKOI6Shm-4Q <-- pega aqu√≠ tu ID de canal
            const maxResults = 6; // n√∫mero de videos que quieres mostrar

            async function cargarVideos() {
            const res = await fetch(
                `https://www.googleapis.com/youtube/v3/search?key=${apiKeys}&channelId=${channelId}&part=snippet,id&order=date&maxResults=${maxResults}`
            );
            const data = await res.json();

            const indicator = document.getElementById("indicators");
            indicator.innerHTML = "";

            const contenedor = document.getElementById("galleryWrapper");
            contenedor.innerHTML = "";


            var primero = true;

            data.items.forEach(video => {
                if (video.id.kind === "youtube#video") {
                  const videoId = video.id.videoId;
                  const titulo = video.snippet.title;
                  const description = video.snippet.description;
                  const thumbnail = video.snippet.thumbnails.medium.url;

                  const col = document.createElement("div");
                  col.classList.add("carousel-item");
                  if (primero) {
                      col.classList.add("active");
                  
                  }
                  // col.setAttribute("data-aos", "zoom-in-up");

                  col.innerHTML = `
                      <div class="card ">
                      
                        <div class="card-body">
                          <div class="ratio ratio-21x9">
                            <iframe
                              src="https://www.youtube.com/embed/${videoId}?rel=0&autoplay=0&mute=0"
                              title="Video de YouTube"
                              allowfullscreen
                              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            ></iframe>
                          </div>
                        </div>
                      </div>
                        <div class="carousel-caption d-none d-md-block caption">
                          <h5>${titulo}</h5>
                          <p>${description}</p>
                        </div>
                  `;
                  
                  contenedor.appendChild(col);

                  // Crear indicadores
                  const button = document.createElement("button");
                  button.type = "button";
                  button.setAttribute("data-bs-target", "#carouselExampleCaptions");
                  button.setAttribute("data-bs-slide-to", indicator.children.length);
                  button.setAttribute("aria-label", `Slide ${indicator.children.length + 1}`);
                  if (primero) {
                      button.classList.add("active");
                      button.setAttribute("aria-current", "true");
                      primero = false;
                  }
                  indicator.appendChild(button);
                }
            });

            // Evento para reproducir dentro del modal
            document.querySelectorAll(".video-thumbnail").forEach(el => {
                el.addEventListener("click", () => {
                const videoId = el.getAttribute("data-video");
                const iframe = document.getElementById("youtubeFrame");
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                });
            });

            // Limpiar el iframe al cerrar el modal
            document.getElementById("modalVideo").addEventListener("hidden.bs.modal", () => {
                document.getElementById("youtubeFrame").src = "";
            });

            AOS.refresh();
            }

            cargarVideos();
            
             // üëá Agrega esto debajo
            document.addEventListener("DOMContentLoaded", () => {
              const carousel = document.getElementById("carouselExampleCaptions");

              carousel.addEventListener("slide.bs.carousel", () => {
                const iframes = carousel.querySelectorAll("iframe");
                iframes.forEach((iframe) => {
                  iframe.src = iframe.src;
                });
              });
            });
</script>
</body>
</html>
